<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Template Email pour Facture de Loyer -->
    <record id="email_template_rental_invoice" model="mail.template">
        <field name="name">Facture de Loyer - Notification</field>
        <field name="model_id" ref="account.model_account_move" />
        <field name="subject">
            Facture de Loyer {{ object.name }} - {{ object.rental_contract_id.property_id.name or ''
            }}
        </field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="lang">{{ object.partner_id.lang }}</field>
        <field name="auto_delete" eval="False" />

        <field name="body_html" type="html">
            <div
                style="margin: 0px; padding: 0px; font-family: Arial, Helvetica, sans-serif; font-size: 14px;">
                <table border="0" cellpadding="0" cellspacing="0"
                    style="padding-top: 16px; background-color: #F1F1F1; font-family:Verdana, Arial,sans-serif; color: #555; width: 100%; border-collapse:separate;">
                    <tbody>
                        <tr>
                            <td align="center">
                                <table border="0" cellpadding="0" cellspacing="0" width="590"
                                    style="padding: 16px; background-color: white; border: 1px solid #e0e0e0;">
                                    <tbody>
                                        <!-- Header -->
                                        <tr>
                                            <td align="center" style="padding: 10px 0px;">
                                                <img src="https://portail.toubasandaga.sn/logo.png" style="height: 60px;" alt="logo"/>

                                            </td>
                                        </tr>

                                        <!-- Titre -->
                                        <tr>
                                            <td
                                                style="padding: 20px 0px; font-size: 20px; font-weight: bold; color: #333;">
                                                Bonjour <span
                                                    t-out="object.partner_id.name or 'N/A'" />, </td>
                                        </tr>

                                        <!-- Message Principal -->
                                        <tr>
                                            <td style="padding: 10px 0px; line-height: 22px;"> Votre
                                                facture de loyer pour le local <strong>
                                                    <span
                                                        t-out="object.rental_contract_id.property_id.name or 'N/A'" />
                                                </strong>
                                                est maintenant disponible. </td>
                                        </tr>

                                        <!-- D√©tails de la Facture -->
                                        <tr>
                                            <td style="padding: 20px 0px;">
                                                <table border="0" cellpadding="5" cellspacing="0"
                                                    width="100%" style="border: 1px solid #e0e0e0;">
                                                    <tr style="background-color: #f5f5f5;">
                                                        <td
                                                            style="padding: 10px; font-weight: bold;">Num√©ro
                                                            de Facture</td>
                                                        <td style="padding: 10px;">
                                                            <span t-out="object.name or 'N/A'" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td
                                                            style="padding: 10px; font-weight: bold;">
                                                            Local</td>
                                                        <td style="padding: 10px;">
                                                            <span
                                                                t-out="object.rental_contract_id.property_id.name or 'N/A'" />
                                                        </td>
                                                    </tr>
                                                    <tr style="background-color: #f5f5f5;">
                                                        <td
                                                            style="padding: 10px; font-weight: bold;">Date
                                                            d'√âch√©ance</td>
                                                        <td style="padding: 10px;">
                                                            <span
                                                                t-out="format_date(object.invoice_date_due) or 'N/A'" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td
                                                            style="padding: 10px; font-weight: bold; font-size: 16px;">Montant
                                                            √† Payer</td>
                                                        <td
                                                            style="padding: 10px; font-size: 18px; font-weight: bold; color: #007bff;">
                                                            <span
                                                                t-out="object.amount_total and '{:,.0f}'.format(object.amount_total).replace(',', ' ') or 'N/A'" />
                                                            <span
                                                                t-out="object.currency_id.symbol or 'N/A'" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>

                                        <!-- Boutons de Paiement -->
                                        <tr>
                                            <td style="padding: 20px 0px; text-align: center;">
                                                <p
                                                    style="margin-bottom: 15px; font-weight: bold; color: #333;">Choisissez
                                                    votre moyen de paiement :</p>

                                                <!-- Wave -->
                                                <div style="margin: 10px 0;">
                                                    <a t-att-href="object.payment_link_wave or '#'"
                                                        style="display: inline-block; padding: 12px 24px; margin: 5px; background-color: #00A3E0; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
                                                        üí≥ Payer avec Wave
                                                    </a>
                                                </div>

                                                <!-- Orange Money -->
                                                <div style="margin: 10px 0;">
                                                    <a
                                                        t-att-href="object.payment_link_orange_money or '#'"
                                                        style="display: inline-block; padding: 12px 24px; margin: 5px; background-color: #FF7900; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
                                                        üí≥ Payer avec Orange Money
                                                    </a>
                                                </div>

                                                <!-- Section Virement Bancaire avec v√©rification -->
                                                <t t-if="object.company_id.partner_id.bank_ids">
                                                    <div
                                                        style="margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-left: 4px solid #007bff;">
                                                        <p style="margin: 0; font-weight: bold;">Paiement
                                                            par Virement Bancaire</p>
                                                        <p style="margin: 5px 0; font-size: 12px;">
                                                            <strong>Banque:</strong>
                                                            <span
                                                                t-out="object.company_id.partner_id.bank_ids[0].bank_name or 'N/A'" />
                                                            <br />
                                                            <strong>IBAN:</strong>
                                                            <span
                                                                t-out="object.company_id.partner_id.bank_ids[0].acc_number or 'N/A'" />
                                                            <br />
                                                        </p>
                                                    </div>
                                                </t>
                                                <t t-else="">
                                                    <div
                                                        style="margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-left: 4px solid #007bff;">
                                                        <p style="margin: 0; font-weight: bold;">Paiement
                                                            par Virement Bancaire</p>
                                                        <p style="margin: 5px 0; font-size: 12px;">
                                                            <strong>Banque:</strong> N/A<br />
                                                            <strong>
                                                            IBAN:</strong> N/A<br />
                                                        </p>
                                                    </div>
                                                </t>
                                            </td>
                                        </tr>

                                        <!-- Pi√®ce Jointe -->
                                        <tr>
                                            <td style="padding: 20px 0px;">
                                                <p>Vous trouverez votre facture en pi√®ce jointe de
                                                    ce message.</p>
                                            </td>
                                        </tr>

                                        <!-- Footer -->
                                        <tr>
                                            <td
                                                style="padding: 20px 0px; border-top: 1px solid #e0e0e0; text-align: center; color: #888; font-size: 12px;">
                                                <p>Pour toute question, contactez-nous :</p>
                                                <p> üìß <span
                                                        t-out="object.company_id.email or 'N/A'" /><br />
                                                    üìû <span
                                                        t-out="object.company_id.phone or 'N/A'" /><br />
                                                    üè¢ <span t-out="object.company_id.name or 'N/A'" />
                                                </p>
                                                <p style="margin-top: 20px;">
                                                    Merci de votre confiance !
                                                </p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </field>

        <!-- Attacher le PDF de la facture -->
        <field name="report_template" ref="account.account_invoices" />
        <field name="report_name">
            Facture_{{ (object.name or '').replace('/','_') }}
        </field>
    </record>

    <!-- Template Email pour Rappel de Paiement -->
    <record id="email_template_payment_reminder" model="mail.template">
        <field name="name">Rappel de Paiement - Loyer</field>
        <field name="model_id" ref="account.model_account_move" />

        <field name="subject">‚ö†Ô∏è Rappel - Facture {{ object.name }} en retard</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="lang">{{ object.partner_id.lang }}</field>


        <field name="body_html" type="html">
            <div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
                <table border="0" width="590" cellpadding="16"
                    style="background-color: white; border: 1px solid #e0e0e0; margin: 20px auto;">
                    <tr>
                        <td
                            style="background-color: #ff9800; color: white; padding: 15px; font-size: 18px; font-weight: bold;">
                            RAPPEL DE PAIEMENT
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 20px;">
                            <p>Bonjour <span t-out="object.partner_id.name or 'N/A'" />,</p>
                            <p>Nous constatons que votre facture de loyer n¬∞<strong>
                                    <span t-out="object.name or 'N/A'" />
                                </strong>
                                n'a pas encore √©t√© r√©gl√©e.</p>

                            <div
                                style="background-color: #fff3cd; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0;">
                                <p style="margin: 0;">
                                    <strong>Montant d√ª:</strong>
                                    <span
                                        t-out="object.amount_residual and '{:,.0f}'.format(object.amount_residual).replace(',', ' ') or 'N/A'" />
                                    <span t-out="object.currency_id.symbol or 'N/A'" />
                                </p>
                                <p style="margin: 5px 0;">
                                    <strong>Date d'√©ch√©ance:</strong>
                                    <span t-out="format_date(object.invoice_date_due) or 'N/A'" />
                                </p>
                                <p style="margin: 5px 0;">
                                    <strong>Local:</strong>
                                    <span
                                        t-out="object.rental_contract_id.property_id.name or 'N/A'" />
                                </p>
                            </div>

                            <p>Merci de r√©gulariser votre situation dans les plus brefs d√©lais.</p>

                            <p style="margin-top: 30px;">Cordialement,<br /><span
                                    t-out="object.company_id.name or 'N/A'" /></p>
                        </td>
                    </tr>
                </table>
            </div>
        </field>
    </record>

</odoo>